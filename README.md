# ccloud-node-console-client
Example console consumer and console producer using Node.JS and Confluent Cloud

# Features

* Up to date support for Confluent Cloud - Apache Kafka as a Service (see https://www.confluent.io/confluent-cloud/)
* Up to date feature set from use of node-rdkafka node.js client (see https://github.com/Blizzard/node-rdkafka)
* Tested on Linux, macOS
* Supports dynamic topic, key, value, and partition inputs
* Supports 0.10 and 0.11 timestamps

# Dependencies

Linux dependencies

* openssl-dev
* libsasl2-dev
* libsasl2-modules
* C++ toolchain

macOS dependencies

* Brew
* Apple Xcode command line tools (for the compiler)
* openssl via Brew
* Export CPPFLAGS=-I/usr/local/opt/openssl/include and LDFLAGS=-L/usr/local/opt/openssl/lib
* Open Keychain Access, export all certificates in System Roots to a single .pem file

# Install

Install ccloud-node-console-client from source

	brew install openssl
	export CPPFLAGS=-I/usr/local/opt/openssl/include
	export LDFLAGS=-L/usr/local/opt/openssl/lib
	cd /tmp	
	git clone git@github.com:hjespers/ccloud-node-console-client-ccloud.git
	sudo -E npm install -g /tmp/ccloud-node-console-client


# Uninstall

	sudo npm uninstall -g ccloud-node-console-client


# Useage

	ccloud-console-producer --help
	Usage: ccloud-console-producer -e <endpoint> -k <apikey> -s <apisecret> -t <topic> -S <ssl ca location> -v

	Options:
	  -e, --endpoint   Confluent Cloud Endpoints (Broker List)  [required]
	  -k, --apikey     Confluent Cloud API Key                  [required]
	  -s, --apisecret  Confluent Cloud API Secret               [required]
	  -t, --topic      Kafka Topic to consume from              [required]
	  -v, --verbose    Verbose mode                             [boolean]
	  -S, --sslcaloc   SSL CA Location                          [default: "/usr/local/etc/openssl/cert.pem"]
	  -?, --help       Print usage information

	Missing required arguments: e, k, s, t


	ccloud-console-consumer --help
	Usage: ccloud-console-consumer -e <endpoint> -k <apikey> -s <apisecret> -t <topic> -c <consumer group id> -S <ssl ca location> -v

	Options:
	  -e, --endpoint   Confluent Cloud Endpoints (Broker List)       [required]
	  -k, --apikey     Confluent Cloud API Key                       [required]
	  -s, --apisecret  Confluent Cloud API Secret                    [required]
	  -t, --topic      Kafka Topic to consume from                   [required]
	  -c, --cgid       Consumer group.id (defaults to autogenerated
	  -v, --verbose    Verbose mode
	  -S, --sslcaloc   SSL CA Location                               [default: "/usr/local/etc/openssl/cert.pem"]
	  -?, --help       Print usage information

	Missing required arguments: e, k, s, t


## Example Consumer

	$ ccloud-console-consumer -e $CCLOUD_BROKERS -k $CCLOUD_SASL_USERNAME -s $CCLOUD_SASL_PASSWORD -t mytopic -v
	Using consumer group.id = node-console-consumer474198
	Created consumer subscription on topic = mytopic
	Got a message on topic "mytopic"
	{ value: <Buffer 22 68 65 6c 6c 6f 20 63 63 6c 6f 75 64 22>,
	  size: 14,
	  key: 'mykey',
	  topic: 'mytopic',
	  offset: 251,
	  partition: 7 }
	calling commit
	<Control-C>
	Caught interrupt signal
	consumer disconnected. {"connectionOpened":1498680438074}

## Example Producer

	$ ccloud-console-producer -e $CCLOUD_BROKERS -k $CCLOUD_SASL_USERNAME -s $CCLOUD_SASL_PASSWORD -t mytopic
	Confluent Cloud connection is ready
	prompt: key:  mykey
	prompt: value:  hello ccloud
	prompt: partition:
	Command-line input received:
	  Message key: mykey
	  Message value: hello ccloud
	Message published

# Troubleshooting

Caught error: Error: Invalid value for configuration property "security.protocol"
